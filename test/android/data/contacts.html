<html>
<head>
  <title></title>
</head>
<style type="text/css">
  body { margin: auto; width: 100%; }
  div { margin: 15; padding: 10; width: 100%; }
  textarea { margin: 10; padding: 10; width: 95%; height: 15%; font-size: 12; resize: none;}
  .title { margin: 20; padding: 20; font-size: 42; font-weight: bold; }
  .subtitle { margin: 10; padding: 10; font-size: 32; }
  .text { font-size: 25; }
  .center { text-align: center; }
  .save { background-color: #FFFACD; }
  .update { background-color: #CAE1FF; }
  .find { background-color: #FFF0F5; }
</style>
<body>

<script>

var ErrorHandler = function(error) {
  document.title = 'Fail';
  console.log(error);
}

var successCount = 0;
function onSuccess() {
  ++successCount;
  if (successCount >= 2) { // TODO(hdq) will increase it after adding more modules.
    document.title = 'Pass';
  }
}

function ContactName(init) {
  this.displayName = init.displayName;
  this.honorificPrefixes = init.honorificPrefixes;
  this.givenNames = init.givenNames;
  this.familyNames = init.familyNames;
  this.nickNames = init.nickNames;
}

function ContactField(init) {
  this.types = init.types;
  this.prefered = init.prefered;
  this.value = init.value;
}

function ContactTelField(init) {
  this.carrier = init.carrier;
  this.types = init.types;
  this.prefered = init.prefered;
  this.value = init.value;
}

function Contact(init) {
  this.name = init.name;
  this.emails = init.emails;
  this.phoneNumbers = init.phoneNumbers;
}

window.onload = function() {

  var contactName = new ContactName({
    givenNames: ['John'],
    familyNames: ['Doe']
  });

  var mobilePhone = new ContactTelField({
    types: ['home'],
    preferred: true,
    value: '+44698765432'
  });

  var contact = new Contact({
    name: contactName,
    phoneNumbers: [mobilePhone]
  });

  try {
    navigator.contacts.save(contact)
      .done(function(contact) {
        var output = 'Contact ' +
          contact.name.givenNames[0] + ' ' +
          contact.name.familyNames[0] + ' saved!';
        document.getElementById('save').innerHTML = output;
        onSuccess();
      }, ErrorHandler)
      .done(function(contact) {
        //TODO(hdq) will add test case for update a contact based on returned contact id
      }, ErrorHandler);
  } catch(e) {
    console.log(e);
  }
};

</script>

<div class="title center">Contacts API Example</div>

<div class="save">
  <p class="subtitle center">Save A Contact</p>
  <p class="text center" id="save"></p>
</div>

<div class="update">
  <p class="subtitle center">Update A Contact</p>
  <p class="text center" id="update"></p>
</div>

<div class="find">
  <p class="subtitle center">Find A Contact</p>
  <p class="text" id="find"></p>
</div>

</body>
</html>
